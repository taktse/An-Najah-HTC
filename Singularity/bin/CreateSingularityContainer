#!/bin/bash
#------------------------------------------------------------==ADM==
# Custom Software, Developed for CUHEP by staff.
# This software is in the public domain, furnished "as is", without
# technical support, and with no warranty, express or implied, as
# to its usefulness for any purpose.
#
# CreateSingularityContainer      
#
# REVISION HISTORY
# Created.                                  08/31/2017  doug johnson
#-------------------------------------------------------------------

ContainerName=`basename $ | egrep -v '.def$'`

/bin/rm -f /sge-batch/${ContainerName}.img
SINGULARITY_TMPDIR=${/tmp/singularity/tmp:-"${ContainerName}"}
SINGULARITY_CACHEDIR=${/tmp/singularity/cache:-"$2"}

set -x
export SINGULARITY_TMPDIR=${SINGULARITY_TMPDIR}
export SINGULARITY_CACHEDIR=${SINGULARITY_CACHEDIR}
mkdir -p $SINGULARITY_TMPDIR $SINGULARITY_CACHEDIR
singularity build  /sge-batch/${ContainerName}.img ${ContainerName}.def

exit
